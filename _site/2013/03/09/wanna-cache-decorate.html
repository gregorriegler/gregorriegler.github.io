<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="https://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
      Wanna Cache? Decorate!! &middot; Gregor Riegler
    
  </title>

  


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.ico" />

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <!-- Additional head bits without overriding original head -->
</head>


  <body class="post">

    <div id="sidebar">
  <header>
    <div class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        Gregor Riegler
      </a>
    </div>
    <p class="lead">merciless refactorer</p>
  </header>
  <nav id="sidebar-nav-links">
  

  


  

  
    
  

  
    
  

  
    
  

  

  
    
  

  

  

  
    
      <a class="page-link "
          href="/about">about</a>
    
  

  
    
      <a class="page-link "
          href="/blog">blog</a>
    
  

  
    
      <a class="page-link "
          href="/speaking">speaking</a>
    
  

  
    
      <a class="page-link "
          href="/refactoring-java/">refactoring java video series</a>
    
  



  

  

  


  

  
    
  

  
    
  

  
    
  

  

  
    
  

  

  

  
    
  

  
    
  

  
    
  

  
    
  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>


  

  <nav id="sidebar-icon-links">

  
  <a id="twitter-link"
     class="icon" title="Twitter" aria-label="Twitter"
     href="http://www.twitter.com/gregor_riegler">
    <?xml version="1.0" ?><!DOCTYPE svg  PUBLIC '-//W3C//DTD SVG 1.1//EN'  'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'><svg enable-background="new 0 0 56.693 56.693" height="56.693px" id="Layer_1" version="1.1" viewBox="0 0 56.693 56.693" width="56.693px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M52.837,15.065c-1.811,0.805-3.76,1.348-5.805,1.591c2.088-1.25,3.689-3.23,4.444-5.592c-1.953,1.159-4.115,2-6.418,2.454  c-1.843-1.964-4.47-3.192-7.377-3.192c-5.581,0-10.106,4.525-10.106,10.107c0,0.791,0.089,1.562,0.262,2.303  c-8.4-0.422-15.848-4.445-20.833-10.56c-0.87,1.492-1.368,3.228-1.368,5.082c0,3.506,1.784,6.6,4.496,8.412  c-1.656-0.053-3.215-0.508-4.578-1.265c-0.001,0.042-0.001,0.085-0.001,0.128c0,4.896,3.484,8.98,8.108,9.91  c-0.848,0.23-1.741,0.354-2.663,0.354c-0.652,0-1.285-0.063-1.902-0.182c1.287,4.015,5.019,6.938,9.441,7.019  c-3.459,2.711-7.816,4.327-12.552,4.327c-0.815,0-1.62-0.048-2.411-0.142c4.474,2.869,9.786,4.541,15.493,4.541  c18.591,0,28.756-15.4,28.756-28.756c0-0.438-0.009-0.875-0.028-1.309C49.769,18.873,51.483,17.092,52.837,15.065z"/></svg>
  </a>
  

  <a id="github-link"
     class="icon" title="Github" aria-label="Github"
     href="https://github.com/gregorriegler">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 28" height="24" width="28"><path d="M12 2c6.625 0 12 5.375 12 12 0 5.297-3.437 9.797-8.203 11.391-0.609 0.109-0.828-0.266-0.828-0.578 0-0.391 0.016-1.687 0.016-3.297 0-1.125-0.375-1.844-0.812-2.219 2.672-0.297 5.484-1.313 5.484-5.922 0-1.313-0.469-2.375-1.234-3.219 0.125-0.313 0.531-1.531-0.125-3.187-1-0.313-3.297 1.234-3.297 1.234-0.953-0.266-1.984-0.406-3-0.406s-2.047 0.141-3 0.406c0 0-2.297-1.547-3.297-1.234-0.656 1.656-0.25 2.875-0.125 3.187-0.766 0.844-1.234 1.906-1.234 3.219 0 4.594 2.797 5.625 5.469 5.922-0.344 0.313-0.656 0.844-0.766 1.609-0.688 0.313-2.438 0.844-3.484-1-0.656-1.141-1.844-1.234-1.844-1.234-1.172-0.016-0.078 0.734-0.078 0.734 0.781 0.359 1.328 1.75 1.328 1.75 0.703 2.141 4.047 1.422 4.047 1.422 0 1 0.016 1.937 0.016 2.234 0 0.313-0.219 0.688-0.828 0.578-4.766-1.594-8.203-6.094-8.203-11.391 0-6.625 5.375-12 12-12zM4.547 19.234c0.031-0.063-0.016-0.141-0.109-0.187-0.094-0.031-0.172-0.016-0.203 0.031-0.031 0.063 0.016 0.141 0.109 0.187 0.078 0.047 0.172 0.031 0.203-0.031zM5.031 19.766c0.063-0.047 0.047-0.156-0.031-0.25-0.078-0.078-0.187-0.109-0.25-0.047-0.063 0.047-0.047 0.156 0.031 0.25 0.078 0.078 0.187 0.109 0.25 0.047zM5.5 20.469c0.078-0.063 0.078-0.187 0-0.297-0.063-0.109-0.187-0.156-0.266-0.094-0.078 0.047-0.078 0.172 0 0.281s0.203 0.156 0.266 0.109zM6.156 21.125c0.063-0.063 0.031-0.203-0.063-0.297-0.109-0.109-0.25-0.125-0.313-0.047-0.078 0.063-0.047 0.203 0.063 0.297 0.109 0.109 0.25 0.125 0.313 0.047zM7.047 21.516c0.031-0.094-0.063-0.203-0.203-0.25-0.125-0.031-0.266 0.016-0.297 0.109s0.063 0.203 0.203 0.234c0.125 0.047 0.266 0 0.297-0.094zM8.031 21.594c0-0.109-0.125-0.187-0.266-0.172-0.141 0-0.25 0.078-0.25 0.172 0 0.109 0.109 0.187 0.266 0.172 0.141 0 0.25-0.078 0.25-0.172zM8.937 21.438c-0.016-0.094-0.141-0.156-0.281-0.141-0.141 0.031-0.234 0.125-0.219 0.234 0.016 0.094 0.141 0.156 0.281 0.125s0.234-0.125 0.219-0.219z"></path>
</svg>

  </a>

  <a id="youtube-link"
     class="icon" title="Youtube" aria-label="Youtube"
     href="https://www.youtube.com/channel/UCsWg_i6X4KMhjD2CRqCJLdg">
    <?xml version="1.0" encoding="iso-8859-1"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="96.875px" height="96.875px" viewBox="0 0 96.875 96.875" style="enable-background:new 0 0 96.875 96.875;"
	 xml:space="preserve">
<g>
	<path d="M95.201,25.538c-1.186-5.152-5.4-8.953-10.473-9.52c-12.013-1.341-24.172-1.348-36.275-1.341
		c-12.105-0.007-24.266,0-36.279,1.341c-5.07,0.567-9.281,4.368-10.467,9.52C0.019,32.875,0,40.884,0,48.438
		C0,55.992,0,64,1.688,71.336c1.184,5.151,5.396,8.952,10.469,9.52c12.012,1.342,24.172,1.349,36.277,1.342
		c12.107,0.007,24.264,0,36.275-1.342c5.07-0.567,9.285-4.368,10.471-9.52c1.689-7.337,1.695-15.345,1.695-22.898
		C96.875,40.884,96.889,32.875,95.201,25.538z M35.936,63.474c0-10.716,0-21.32,0-32.037c10.267,5.357,20.466,10.678,30.798,16.068
		C56.434,52.847,46.23,58.136,35.936,63.474z"/>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
</svg>

  </a>

  <a id="goodreads-link"
     class="icon" title="goodreads" aria-label="goodreads"
     href="https://www.goodreads.com/user/show/22567057-gregor-riegler">
    <?xml version="1.0" ?><svg style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><style type="text/css">
	.st0{}
	.st1{fill:#202020;}
</style><g id="Edges"/><g id="Background_1_"><path class="st0" d="M492,268.3c-6.3,122.8-109.9,224.4-236.5,224.5c-126.7,0.1-230.7-101.6-237-224.5   C11.7,136.2,119.6,19.2,255.2,19.2C390.9,19.2,498.7,136.3,492,268.3z"/></g><g id="Symbol"><path class="st1" d="M346.6,137.5c0-4.3-0.4-8.6-0.6-12.8c-9.2,0-16.9,0-25.6,0c0,9.8,0,18.9,0,28.1   c-41.1-57.3-125.6-39.2-149.4,17.9c-15.2,36.6-14.4,73.4,1.5,109.4c16.8,38,65,54.1,102.8,43.4c2-0.3,4.3-0.9,6.8-1.7   c3.6-1.1,6.7-2.5,8.7-3.6c5.2-2.1,11.4-5.6,17.5-10.3c4.9-3.8,9.1-7.8,12.4-11.5c-0.9,14.3-1.3,28.7-3.6,42.8   c-2.8,17.4-10.8,32.4-27.4,41.2c-36.2,19.2-79.6,4.6-96-32.4c-8.2,0-16.6,0-25.4,0c1.8,24.4,14.7,40.3,34.7,50.6   c24.1,12.4,49.9,13.7,76.2,9.4c33.5-5.5,55.3-24.4,63-57.8c2.7-11.9,4.2-24.2,4.3-36.4C346.8,255,346.6,196.2,346.6,137.5z    M316.5,260.3c-4.8,13.8-12.8,24.7-23.3,32.2c-2.6,1.9-15.4,10.8-34.1,11.7c-1.1,0.1-4.2,0.2-8,0c-0.1,0.1-0.3,0.1-0.4,0.1   c-27.3-1.7-48.2-17.6-57.4-43.9c-7.7-22.1-7.9-44.6-2.3-67.1c8.1-32.5,31.6-52.4,61.6-53.2c0.7-0.1,1.1-0.1,1.1-0.1   c15.6-1.4,27.8,5.1,31.6,7.2c16.1,8.6,28.2,24.6,33.5,46C324.4,215.7,324.2,238.2,316.5,260.3z"/></g></svg>
  </a>

  <a id="email-link"
     class="icon" title="e-mail" aria-label="e-mail"
     href="mailto:rieglerg85@gmail.com">
    <?xml version="1.0" encoding="iso-8859-1"?>
<!-- Generator: Adobe Illustrator 18.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 493.332 493.332" style="enable-background:new 0 0 493.332 493.332;" xml:space="preserve">
<g id="XMLID_78_">
	<g id="XMLID_79_">
		<g id="XMLID_80_">
			<path id="XMLID_81_" d="M352.731,450.956c3.037,9.789-2.044,20.213-11.616,23.878c-35.811,13.709-69.294,18.498-112.873,18.498
				c-117.663,0-221.147-84.347-221.147-223.275C7.095,125.46,112.003,0,272.2,0c124.735,0,214.036,85.764,214.036,204.845
				c0,103.483-58.12,168.693-134.66,168.693c-33.327,0-57.419-17.007-60.955-54.582h-1.424c-21.963,36.15-53.86,54.582-91.43,54.582
				c-46.082,0-79.376-34.022-79.376-92.142c0-86.475,63.769-165.147,165.841-165.147c18.691,0,38.9,2.795,55.909,7.172
				c16.425,4.227,26.861,20.236,24.147,36.978l-16.972,104.695c-7.072,41.818-2.112,60.953,17.721,61.666
				c30.475,0.711,68.762-38.272,68.762-119.786c0-92.15-59.543-163.732-169.41-163.732c-108.444,0-203.428,85.051-203.428,220.436
				c0,118.369,75.834,185.708,181.448,185.708c27.489,0,56.203-4.51,80.853-13.214c5.863-2.07,12.315-1.662,17.872,1.126
				c5.558,2.788,9.753,7.716,11.595,13.655L352.731,450.956z M293.954,181.362c0.534-3.626-1.892-7.027-5.496-7.696
				c-4.413-0.819-9.536-1.426-15.573-1.426c-46.771,0-83.617,46.076-83.617,100.653c0,26.94,12.037,43.946,35.423,43.946
				c26.231,0,53.876-33.31,60.265-74.425L293.954,181.362z"/>
		</g>
	</g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
</svg>

  </a>

  <a id="subscribe-link"
     class="icon" title="Subscribe" aria-label="Subscribe"
     href="/feed.xml">
    <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>
  </a>

  
  
  
  

  

  

  <!-- Optional additional links to insert for icons links -->
</nav>

  <p class="license">
  &copy; 2020.  <a href="/LICENSE.md">MIT License.</a>
</p>

</div>

    <main class="container">
      <header>
  <h1 class="post-title">Wanna Cache? Decorate!!</h1>
</header>
<div class="content">
  <div class="post-meta">
  <span class="post-date">09 Mar 2013</span>
  <span class="post-categories">
    
  </span>
</div>


  <div class="post-body">
    <h2>The Decorator Pattern</h2>Class Diagram: <br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-5tWIyDICVvM/UTtSn3qThiI/AAAAAAAAAAg/AYI4tvgmpyA/s1600/decorator_pattern.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-5tWIyDICVvM/UTtSn3qThiI/AAAAAAAAAAg/AYI4tvgmpyA/s1600/decorator_pattern.png" /></a></div><div class="separator" style="clear: both; text-align: center;"></div><br />Decorator Pattern is one of the most powerful Design Patterns, and its important to understand why. It allows you to add functionality to a Class without changing it. You use delegation instead of inheritance by just wrapping the existing Class in a "Suite" of your choice while the Interface stays the same. This way, you can even wrap a Class into multiple layers of Decorators where every Layer has its own and different purpose, and the Original Class even stays the same. Other than that the Layers are completely interchangeable and removable, because they all have the same Interface.<br />You can use your naked Object in the same manner as a decorated one with multiple Layers, and the rest of the Application wont even notice. Other components dont need to know whether a Class is decorated or not, because the only thing they care about is the Interface. The following Graphic should clear things up:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-gQHsPM_WUD0/UTtTP8ndLhI/AAAAAAAAAAo/33AtWE7cvNM/s1600/cache_decorator_steps.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-gQHsPM_WUD0/UTtTP8ndLhI/AAAAAAAAAAo/33AtWE7cvNM/s1600/cache_decorator_steps.png" /></a></div>Just follow the Steps:<br />In the first example there is no Decorator. So SomeClass directly speaks to BookService<br />In the second example there is a single Decorator. Therefore the following steps apply<br /><ol><li>SomeClass calls SomeDecoratorA.</li><li>SomeDecoratorA delegates the call to the real BookService. The Decorator could even manipulate the call in this step.</li><li>BookService returns a result. SomeDecoratorA now holds the result, and may manipulate it.</li><li>Finally, SomeDecoratorA hands the result over to the original caller SomeClass.</li></ol>In the third example, there are even 2 Nested Decorators. Since every Decorator speaks the Interface of the BookService Class you can wrap an infinite amount of Decorators upon.<br /><br /><h3>Usage Examples</h3>Most examples in Books and online Guides describe the Decorator Pattern used by some Graphic related stuff. You would have a normal line, and a line decorated with a shadow. Another example would be a Window in a GUI where you vary Decorators that add different kinds of styles (e.g. different Colors).<br /><br />But its important to understand, that Decorators are not intended to just make Styling more dynamic. It is just one way to use them. Instead, there are many more great use cases for Decorators and i will show you an example applying cache functionality.<br /><br /><h3>Applying Cache with Decorator Pattern</h3>Class Diagram:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-QeqCL_o0nQo/UTtV93LNgLI/AAAAAAAAAAw/SAP7zX3arnE/s1600/decorator_cache.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-QeqCL_o0nQo/UTtV93LNgLI/AAAAAAAAAAw/SAP7zX3arnE/s1600/decorator_cache.png" /></a></div><br />As you can see i am adding a BookServiceCacheDecorator that holds a Cache Component which temporarily stores a List of Books. The BookServiceCacheDecorator in the first place asks the Cache if there is a result available. If thats true, the decorator will use the cached result. Otherwise it will fetch the Result of the BookService itself, and store the Result in the Cache for later use.<br /><br />I start with the BookService Interface,<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2<br />3</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: green; font-weight: bold;">public</span> <span style="color: green; font-weight: bold;">interface</span> <span style="color: #b00060; font-weight: bold;">BookService</span> <span style="color: #303030;">{</span><br />    <span style="color: green; font-weight: bold;">public</span> List<span style="color: #303030;">&lt;</span>Book<span style="color: #303030;">&gt;</span> findAll<span style="color: #303030;">();</span><br /><span style="color: #303030;">}</span><br /></pre></td></tr></tbody></table></div><br />and its prime implementation.<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: green; font-weight: bold;">public</span> <span style="color: green; font-weight: bold;">class</span> <span style="color: #b00060; font-weight: bold;">BookServiceImpl</span> <span style="color: green; font-weight: bold;">implements</span> BookService <span style="color: #303030;">{</span><br /><br />    <span style="color: #505050; font-weight: bold;">@Override</span><br />    <span style="color: green; font-weight: bold;">public</span> List<span style="color: #303030;">&lt;</span>Book<span style="color: #303030;">&gt;</span> findAll<span style="color: #303030;">()</span> <span style="color: #303030;">{</span><br />        System<span style="color: #303030;">.</span><span style="color: #0000c0;">out</span><span style="color: #303030;">.</span><span style="color: #0000c0;">println</span><span style="color: #303030;">(</span><span style="background-color: #fff0f0;">"load new data"</span><span style="color: #303030;">);</span><br />        List<span style="color: #303030;">&lt;</span>Book<span style="color: #303030;">&gt;</span> books <span style="color: #303030;">=</span> <span style="color: green; font-weight: bold;">new</span> ArrayList<span style="color: #303030;">&lt;</span>Book<span style="color: #303030;">&gt;();</span><br />        books<span style="color: #303030;">.</span><span style="color: #0000c0;">add</span><span style="color: #303030;">(</span><span style="color: green; font-weight: bold;">new</span> Book<span style="color: #303030;">(</span><span style="background-color: #fff0f0;">"BookA"</span><span style="color: #303030;">));</span><br />        books<span style="color: #303030;">.</span><span style="color: #0000c0;">add</span><span style="color: #303030;">(</span><span style="color: green; font-weight: bold;">new</span> Book<span style="color: #303030;">(</span><span style="background-color: #fff0f0;">"BookB"</span><span style="color: #303030;">));</span><br />        books<span style="color: #303030;">.</span><span style="color: #0000c0;">add</span><span style="color: #303030;">(</span><span style="color: green; font-weight: bold;">new</span> Book<span style="color: #303030;">(</span><span style="background-color: #fff0f0;">"BookC"</span><span style="color: #303030;">));</span><br />        <span style="color: green; font-weight: bold;">return</span> books<span style="color: #303030;">;</span><br />    <span style="color: #303030;">}</span><br /><span style="color: #303030;">}</span><br /></pre></td></tr></tbody></table></div><br />Here is the Code of the Cache Class. In this example it's caching forever, but thats alright.<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: green; font-weight: bold;">public</span> <span style="color: green; font-weight: bold;">class</span> <span style="color: #b00060; font-weight: bold;">Cache</span> <span style="color: #303030;">{</span><br /><br />    <span style="color: green; font-weight: bold;">private</span> List<span style="color: #303030;">&lt;</span>Book<span style="color: #303030;">&gt;</span> storage<span style="color: #303030;">;</span><br /><br />    <span style="color: green; font-weight: bold;">public</span> <span style="color: #303090; font-weight: bold;">void</span> <span style="color: #0060b0; font-weight: bold;">save</span><span style="color: #303030;">(</span>List<span style="color: #303030;">&lt;</span>Book<span style="color: #303030;">&gt;</span> books<span style="color: #303030;">){</span><br />        <span style="color: green; font-weight: bold;">this</span><span style="color: #303030;">.</span><span style="color: #0000c0;">storage</span> <span style="color: #303030;">=</span> books<span style="color: #303030;">;</span><br />    <span style="color: #303030;">}</span><br /><br />    <span style="color: green; font-weight: bold;">public</span> <span style="color: #303090; font-weight: bold;">boolean</span> <span style="color: #0060b0; font-weight: bold;">hasResult</span><span style="color: #303030;">(){</span><br />        <span style="color: green; font-weight: bold;">if</span><span style="color: #303030;">(</span>storage <span style="color: #303030;">!=</span> <span style="color: green; font-weight: bold;">null</span><span style="color: #303030;">){</span><br />            <span style="color: green; font-weight: bold;">return</span> <span style="color: green; font-weight: bold;">true</span><span style="color: #303030;">;</span><br />        <span style="color: #303030;">}</span><br /><br />        <span style="color: green; font-weight: bold;">return</span> <span style="color: green; font-weight: bold;">false</span><span style="color: #303030;">;</span><br />    <span style="color: #303030;">}</span><br /><br />    <span style="color: green; font-weight: bold;">public</span> List<span style="color: #303030;">&lt;</span>Book<span style="color: #303030;">&gt;</span> load<span style="color: #303030;">(){</span><br />        System<span style="color: #303030;">.</span><span style="color: #0000c0;">out</span><span style="color: #303030;">.</span><span style="color: #0000c0;">println</span><span style="color: #303030;">(</span><span style="background-color: #fff0f0;">"load from cache"</span><span style="color: #303030;">);</span><br />        <span style="color: green; font-weight: bold;">return</span> storage<span style="color: #303030;">;</span><br />    <span style="color: #303030;">}</span><br /><span style="color: #303030;">}</span><br /></pre></td></tr></tbody></table></div><br />Now lets continue with the Decorator Base Class. It has a preemtive Constructor to hand over the decorated Object.<br /><br /><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: green; font-weight: bold;">abstract</span> <span style="color: green; font-weight: bold;">public</span> <span style="color: green; font-weight: bold;">class</span> <span style="color: #b00060; font-weight: bold;">BookServiceDecorator</span> <span style="color: green; font-weight: bold;">implements</span> BookService<span style="color: #303030;">{</span><br /><br />    <span style="color: green; font-weight: bold;">protected</span> BookService decorated<span style="color: #303030;">;</span><br /><br />    <span style="color: green; font-weight: bold;">public</span> <span style="color: #0060b0; font-weight: bold;">BookServiceDecorator</span><span style="color: #303030;">(</span>BookService decorated<span style="color: #303030;">){</span><br />        <span style="color: green; font-weight: bold;">this</span><span style="color: #303030;">.</span><span style="color: #0000c0;">decorated</span> <span style="color: #303030;">=</span> decorated<span style="color: #303030;">;</span><br />    <span style="color: #303030;">}</span><br /><span style="color: #303030;">}</span><br /></pre></td></tr></tbody></table></div><br />And finally the CacheDecorator. It Checks the Cache before calling BookServiceImpl.<br /><br /><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: green; font-weight: bold;">public</span> <span style="color: green; font-weight: bold;">class</span> <span style="color: #b00060; font-weight: bold;">BookServiceCacheDecorator</span> <span style="color: green; font-weight: bold;">extends</span> BookServiceDecorator <span style="color: #303030;">{</span><br /><br />    <span style="color: green; font-weight: bold;">private</span> Cache cache<span style="color: #303030;">;</span><br /><br />    <span style="color: green; font-weight: bold;">public</span> <span style="color: #0060b0; font-weight: bold;">BookServiceCacheDecorator</span><span style="color: #303030;">(</span>BookService decorated<span style="color: #303030;">)</span> <span style="color: #303030;">{</span><br />        <span style="color: green; font-weight: bold;">super</span><span style="color: #303030;">(</span>decorated<span style="color: #303030;">);</span><br />    <span style="color: #303030;">}</span><br /><br />    <span style="color: green; font-weight: bold;">public</span> <span style="color: #0060b0; font-weight: bold;">BookServiceCacheDecorator</span><span style="color: #303030;">(</span>BookService decorated<span style="color: #303030;">,</span> Cache cache<span style="color: #303030;">)</span> <span style="color: #303030;">{</span><br />        <span style="color: green; font-weight: bold;">super</span><span style="color: #303030;">(</span>decorated<span style="color: #303030;">);</span><br />        <span style="color: green; font-weight: bold;">this</span><span style="color: #303030;">.</span><span style="color: #0000c0;">cache</span> <span style="color: #303030;">=</span> cache<span style="color: #303030;">;</span><br />    <span style="color: #303030;">}</span><br /><br />    <span style="color: #505050; font-weight: bold;">@Override</span><br />    <span style="color: green; font-weight: bold;">public</span> List<span style="color: #303030;">&lt;</span>Book<span style="color: #303030;">&gt;</span> findAll<span style="color: #303030;">()</span> <span style="color: #303030;">{</span><br />        <span style="color: green; font-weight: bold;">if</span><span style="color: #303030;">(</span>cache<span style="color: #303030;">.</span><span style="color: #0000c0;">hasResult</span><span style="color: #303030;">()){</span><br />            <span style="color: green; font-weight: bold;">return</span> cache<span style="color: #303030;">.</span><span style="color: #0000c0;">load</span><span style="color: #303030;">();</span><br />        <span style="color: #303030;">}</span><br />        List<span style="color: #303030;">&lt;</span>Book<span style="color: #303030;">&gt;</span> books <span style="color: #303030;">=</span> decorated<span style="color: #303030;">.</span><span style="color: #0000c0;">findAll</span><span style="color: #303030;">();</span><br />        cache<span style="color: #303030;">.</span><span style="color: #0000c0;">save</span><span style="color: #303030;">(</span>books<span style="color: #303030;">);</span><br />        <span style="color: green; font-weight: bold;">return</span> books<span style="color: #303030;">;</span><br />    <span style="color: #303030;">}</span><br /><span style="color: #303030;">}</span><br /></pre></td></tr></tbody></table></div><br />Now two different use cases. One without Decorator, and one with the Cache Decorator:<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9</pre></td><td><pre style="line-height: 125%; margin: 0;">BookService bookService <span style="color: #303030;">=</span> <span style="color: green; font-weight: bold;">new</span> BookServiceImpl<span style="color: #303030;">();</span><br />bookService<span style="color: #303030;">.</span><span style="color: #0000c0;">findAll</span><span style="color: #303030;">();</span> <span style="color: grey;">// prints: load new data</span><br />bookService<span style="color: #303030;">.</span><span style="color: #0000c0;">findAll</span><span style="color: #303030;">();</span> <span style="color: grey;">// prints: load new data</span><br />bookService<span style="color: #303030;">.</span><span style="color: #0000c0;">findAll</span><span style="color: #303030;">();</span> <span style="color: grey;">// prints: load new data</span><br /><br />BookService cachedBookService <span style="color: #303030;">=</span> <span style="color: green; font-weight: bold;">new</span> BookServiceCacheDecorator<span style="color: #303030;">(</span><span style="color: green; font-weight: bold;">new</span> BookServiceImpl<span style="color: #303030;">(),</span> <span style="color: green; font-weight: bold;">new</span> Cache<span style="color: #303030;">());</span><br />cachedBookService<span style="color: #303030;">.</span><span style="color: #0000c0;">findAll</span><span style="color: #303030;">();</span> <span style="color: grey;">// prints: load new data</span><br />cachedBookService<span style="color: #303030;">.</span><span style="color: #0000c0;">findAll</span><span style="color: #303030;">();</span> <span style="color: grey;">// prints: load from cache</span><br />cachedBookService<span style="color: #303030;">.</span><span style="color: #0000c0;">findAll</span><span style="color: #303030;">();</span> <span style="color: grey;">// prints: load from cache</span><br /></pre></td></tr></tbody></table></div><br />Thats basically it. Just read the Code carefully. The final use cases should make clear how the Decorator applies functionality. Decorator pattern really helps you create a very modular Code in many circumstances. You should not be afraid of the additional Classes the Pattern depends on, since they are really not a big deal. The modularity gained easily outweighs them.
    



<div class="post-tags">
  
    <span>
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Java</span>
    </span>
  
    <span>
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Modularity</span>
    </span>
  
    <span>
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Cache</span>
    </span>
  
    <span>
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Decorator Pattern</span>
    </span>
  
    <span>
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Design Patterns</span>
    </span>
  
</div>
  </div>

  
  <section class="comments" id="comments">
    <h2>Comments</h2>
    
  <div id="disqus_thread">
  </div>
  <script>

  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW
  *  TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT:s
  *  https://disqus.com/admin/universalcode/#configuration-variables
  */
  var disqus_config = function () {
    this.page.url = "http://localhost:4000/2013/03/09/wanna-cache-decorate.html";
    this.page.identifier = "" ||
                           "http://localhost:4000/2013/03/09/wanna-cache-decorate.html";
  }
  function loadDisqusComments() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//gregorriegler.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  }

  loadDisqusComments();
  </script>
  <noscript>
    Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript">comments powered by Disqus</a>.
  </noscript>



  </section>

  <section class="related">
  <h2>Related Posts</h2>
  <ul class="posts-list">
    
      <li>
        <h3>
          <a href="/2020/01/01/testing-legacy-cli.html">
            testing a legacy cli app
            <small>01 Jan 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2019/12/17/embellishment-to-decorator.html">
            embellishment to decorator
            <small>17 Dec 2019</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2019/12/08/lift-up-conditional.html">
            lift up conditional
            <small>08 Dec 2019</small>
          </a>
        </h3>
      </li>
    
  </ul>
</section>

</div>

    </main>

    <!-- Optional footer content -->

  </body>
</html>
