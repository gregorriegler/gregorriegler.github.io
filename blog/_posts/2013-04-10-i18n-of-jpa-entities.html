---
layout: post
title: I18n of JPA Entities
date: '2013-04-10T20:17:00.001+02:00'
author: Gregor
tags:
- Java
- JPA
- Hibernate
- I18n
modified_time: '2013-08-03T21:01:12.188+02:00'
thumbnail: http://3.bp.blogspot.com/-VacC_XOpFys/UWWoiXynYII/AAAAAAAAABc/JXllBcRFazE/s72-c/i18n_jpa.png
blogger_id: tag:blogger.com,1999:blog-1178805312154210159.post-5376314230836765159
blogger_orig_url: http://www.beabetterdeveloper.com/2013/04/i18n-of-jpa-entities.html
---

Sadly the support for i18n for Entities in JPA is actually very poor to non-existent. There's just basically no out of the box solution provided by Hibernate &amp; Co, although i18n is a feature that could be considered mandatory for a powerful ORM Framework. If you take a look at PHP for example Doctrine supports i18n very well. So besides some really unpopular i18n extensions on forums/github you are basically on your own.<br /><br /><h3>So how do you do it? </h3>There isn't really a general solution to achieve i18n. There are many different ways and you have to choose which is actually best for you. If you do have a relatively small amount of data and ordering by translations is not necessary you can store "keys" in your tables that are being translated by Spring i18n for example. Spring i18n could store the translations in separate property files. Since you wont have to worry about performance, this is a very easy way to achieve i18n.<br /><br />But lets say you have lots of data, and you need to order it on the database side. With such requirements you are better off storing translations inside your database tables. While there are guides, and also an opensource framework on the internet that implement i18n with one centralized translation-table that holds all translations i highly recommend not to follow that idea. The problem with this solution is, that you will have to add one more join for every field that has to be translated, whereas multiple joins for a single table with lots of data can easily become a performanceissue.<br />Its better to follow the approach to create a separate translation-table for every entity. This means that you would have one entity containing simple data, and another one containing only the fields that require translation. Like so:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-VacC_XOpFys/UWWoiXynYII/AAAAAAAAABc/JXllBcRFazE/s1600/i18n_jpa.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="140" src="http://3.bp.blogspot.com/-VacC_XOpFys/UWWoiXynYII/AAAAAAAAABc/JXllBcRFazE/s320/i18n_jpa.png" width="320" /></a></div><br />This schema is pretty normalized and you only have a single join on fetching an entity, while you can still order appropriate.<br /><br />Your entities would look like this:<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #505050; font-weight: bold;">@Entity</span><br /><span style="color: green; font-weight: bold;">public</span> <span style="color: green; font-weight: bold;">class</span> <span style="color: #b00060; font-weight: bold;">Book</span> <span style="color: #303030;">{</span><br /><br />    <span style="color: #505050; font-weight: bold;">@Id</span><br />    <span style="color: green; font-weight: bold;">private</span> <span style="color: #303090; font-weight: bold;">int</span> isbn<span style="color: #303030;">;</span><br /><br />    <span style="color: green; font-weight: bold;">private</span> String author<span style="color: #303030;">;</span><br /><br />    <span style="color: green; font-weight: bold;">private</span> Date releaseDate<span style="color: #303030;">;</span><br /><br />    <span style="color: #505050; font-weight: bold;">@OneToMany</span><br />    <span style="color: #505050; font-weight: bold;">@JoinColumn</span><span style="color: #303030;">(</span>name <span style="color: #303030;">=</span> <span style="background-color: #fff0f0;">"isbn"</span><span style="color: #303030;">)</span><br />    <span style="color: green; font-weight: bold;">private</span> List<span style="color: #303030;">&lt;</span>BookTranslation<span style="color: #303030;">&gt;</span> translations<span style="color: #303030;">;</span><br /><br />    <span style="color: grey;">// constructor, getters and setters -...</span><br /><br /><span style="color: #303030;">}</span><br /></pre></td></tr></tbody></table></div><br />and that<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #505050; font-weight: bold;">@Entity</span><br /><span style="color: green; font-weight: bold;">public</span> <span style="color: green; font-weight: bold;">class</span> <span style="color: #b00060; font-weight: bold;">BookTranslation</span> <span style="color: green; font-weight: bold;">implements</span> Serializable <span style="color: #303030;">{</span><br /><br />    <span style="color: #505050; font-weight: bold;">@Id</span><br />    <span style="color: green; font-weight: bold;">private</span> <span style="color: #303090; font-weight: bold;">int</span> isbn<span style="color: #303030;">;</span><br /><br />    <span style="color: #505050; font-weight: bold;">@Id</span><br />    <span style="color: green; font-weight: bold;">private</span> String locale<span style="color: #303030;">;</span><br /><br />    <span style="color: green; font-weight: bold;">private</span> String title<span style="color: #303030;">;</span><br /><br />    <span style="color: green; font-weight: bold;">private</span> String description<span style="color: #303030;">;</span><br /><br />    <span style="color: grey;">// constructor, getters and setters -...</span><br /><br /><span style="color: #303030;">}</span><br /></pre></td></tr></tbody></table></div><br />You could then fetch a book with its translations with:<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: green; font-weight: bold;">select</span> b <span style="color: green; font-weight: bold;">from</span> Book b <span style="color: green; font-weight: bold;">join</span> <span style="color: green; font-weight: bold;">fetch</span> b.translations bt <span style="color: green; font-weight: bold;">where</span> bt.locale <span style="color: #303030;">=</span> <span style="background-color: #fff0f0;">'de'</span>;<br /></pre></div><br />If you cannot accept your ServiceLayer to deliver two entities for every Book only because of translations, i suggest you to implement some <a href="http://en.wikipedia.org/wiki/Data_transfer_object">DTO</a> like this BookTO which holds all values.<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: green; font-weight: bold;">public</span> <span style="color: green; font-weight: bold;">class</span> <span style="color: #b00060; font-weight: bold;">BookTO</span> <span style="color: #303030;">{</span><br /><br />    <span style="color: green; font-weight: bold;">private</span> <span style="color: #303090; font-weight: bold;">int</span> isbn<span style="color: #303030;">;</span><br /><br />    <span style="color: green; font-weight: bold;">private</span> String author<span style="color: #303030;">;</span><br /><br />    <span style="color: green; font-weight: bold;">private</span> Date releaseDate<span style="color: #303030;">;</span><br /><br />    <span style="color: green; font-weight: bold;">private</span> String title<span style="color: #303030;">;</span><br /><br />    <span style="color: green; font-weight: bold;">private</span> String description<span style="color: #303030;">;</span><br /><br /><span style="color: #303030;">}</span><br /></pre></td></tr></tbody></table></div><br />You'd just need to map the values of Book and BookTranslation to BookTO within your ServiceLayer and also return BookTO instead of Book in your ServiceLayer.<br /><br />This solution might not always be the most appropriate, but it definitely comes in handy sometimes. 