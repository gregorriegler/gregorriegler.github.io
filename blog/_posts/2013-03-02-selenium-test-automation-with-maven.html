---
layout: post
title: Selenium Test Automation with Maven
date: '2013-03-02T12:10:00.001+01:00'
author: Gregor
tags:
- Automation
- Java
- Selenese
- Selenium
- CI
- Maven
- Integration
- Test
modified_time: '2013-10-24T15:21:16.411+02:00'
blogger_id: tag:blogger.com,1999:blog-1178805312154210159.post-146346452810418487
blogger_orig_url: http://www.beabetterdeveloper.com/2013/03/selenium-test-automation-with-maven.html
---

Today i want to help you manage your Automated GUI Tests (Selenium) better. In the past i have seen many different ways people handle this. Some people just write those plain HTML TestCases with Selenium-IDE, store it somewhere on the HDD and run manually when needed. Others dont even use Selenium-IDE. They write pure Java for Example, and automate their execution with JUnit. My todays solution lies inbetween.<br /><br /><h3>Precondition</h3><ul><li>I want plain HTML TestCases, created with Selenium-IDE. So that someone with little Programming skills can still create them.</li><li>I want these GUI Tests to be run automatically in my Build process, so my CI-Tool can notify me on errors.</li><li>I also want all TestCases under Versioncontrol in my Projects Repository since the Tests grow with the Source.</li><li>I want the most little effort with the highest outcome. So i dont want to export JUnit Tests out of my HTML TestCases since it would be kind of a Duplication - and i want to stick to the DRY Principle.</li></ul><h3>Solution</h3>First of all i create a Folder in my Project for the Selenium-Tests.<br /><br /><b>Folder Structure </b><br /><ol><li>        <label for="src">src</label>        <input checked="checked" id="src" type="checkbox" />        <ol><li>                <label for="main">main</label>                <input id="main" type="checkbox" />            </li><li>                <label for="test">test</label>                <input checked="checked" id="test" type="checkbox" />                <ol><li><label for="java">java</label>                        <input checked="checked" id="java" type="checkbox" />                    </li><li>                        <label for="selenium">selenium</label>                        <input checked="checked" id="selenium" type="checkbox" />                        <ol><li class="file">TestSuite</li><li class="file">SomeTest1</li><li class="file">SomeTest2</li></ol></li></ol></li></ol></li><li class="file">pom.xml</li></ol><h3>Example TestSuite</h3><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #507090;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br /><span style="color: #507090;">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span><br /><span style="color: #007000;">&lt;html</span> <span style="color: #0000c0;">xmlns=</span><span style="background-color: #fff0f0;">"http://www.w3.org/1999/xhtml"</span> <span style="color: #0000c0;">xml:lang=</span><span style="background-color: #fff0f0;">"en"</span> <span style="color: #0000c0;">lang=</span><span style="background-color: #fff0f0;">"en"</span><span style="color: #007000;">&gt;</span><br /><span style="color: #007000;">&lt;head&gt;</span><br />    <span style="color: #007000;">&lt;meta</span> <span style="color: #0000c0;">content=</span><span style="background-color: #fff0f0;">"text/html; charset=UTF-8"</span> <span style="color: #0000c0;">http-equiv=</span><span style="background-color: #fff0f0;">"content-type"</span><span style="color: #007000;">/&gt;</span><br />    <span style="color: #007000;">&lt;title&gt;</span>Test Suite<span style="color: #007000;">&lt;/title&gt;</span><br /><span style="color: #007000;">&lt;/head&gt;</span><br /><span style="color: #007000;">&lt;body&gt;</span><br /><span style="color: #007000;">&lt;table</span> <span style="color: #0000c0;">id=</span><span style="background-color: #fff0f0;">"suiteTable"</span> <span style="color: #0000c0;">cellpadding=</span><span style="background-color: #fff0f0;">"1"</span> <span style="color: #0000c0;">cellspacing=</span><span style="background-color: #fff0f0;">"1"</span> <span style="color: #0000c0;">border=</span><span style="background-color: #fff0f0;">"1"</span> <span style="color: #0000c0;">class=</span><span style="background-color: #fff0f0;">"selenium"</span><span style="color: #007000;">&gt;</span><br />    <span style="color: #007000;">&lt;tbody&gt;</span><br />    <span style="color: #007000;">&lt;tr&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;&lt;b&gt;</span>Test Suite<span style="color: #007000;">&lt;/b&gt;&lt;/td&gt;</span><br />    <span style="color: #007000;">&lt;/tr&gt;</span><br />    <span style="color: #007000;">&lt;tr&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;&lt;a</span> <span style="color: #0000c0;">href=</span><span style="background-color: #fff0f0;">"./SomeTest1.html"</span><span style="color: #007000;">&gt;</span>SomeTest1<span style="color: #007000;">&lt;/a&gt;&lt;/td&gt;</span><br />    <span style="color: #007000;">&lt;/tr&gt;</span><br />    <span style="color: #007000;">&lt;tr&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;&lt;a</span> <span style="color: #0000c0;">href=</span><span style="background-color: #fff0f0;">"./SomeTest2.html"</span><span style="color: #007000;">&gt;</span>SomeTest2<span style="color: #007000;">&lt;/a&gt;&lt;/td&gt;</span><br />    <span style="color: #007000;">&lt;/tr&gt;</span><br />    <span style="color: #007000;">&lt;/tbody&gt;</span><br /><span style="color: #007000;">&lt;/table&gt;</span><br /><span style="color: #007000;">&lt;/body&gt;</span><br /><span style="color: #007000;">&lt;/html&gt;</span><br /></pre></td></tr></tbody></table></div><h3>&nbsp;</h3><h3>Example Test</h3><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33<br />34<br />35<br />36<br />37<br />38<br />39<br />40<br />41<br />42<br />43</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #507090;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br /><span style="color: #507090;">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span><br /><span style="color: #007000;">&lt;html</span> <span style="color: #0000c0;">xmlns=</span><span style="background-color: #fff0f0;">"http://www.w3.org/1999/xhtml"</span> <span style="color: #0000c0;">xml:lang=</span><span style="background-color: #fff0f0;">"en"</span> <span style="color: #0000c0;">lang=</span><span style="background-color: #fff0f0;">"en"</span><span style="color: #007000;">&gt;</span><br /><span style="color: #007000;">&lt;head</span> <span style="color: #0000c0;">profile=</span><span style="background-color: #fff0f0;">"http://selenium-ide.openqa.org/profiles/test-case"</span><span style="color: #007000;">&gt;</span><br />    <span style="color: #007000;">&lt;meta</span> <span style="color: #0000c0;">http-equiv=</span><span style="background-color: #fff0f0;">"Content-Type"</span> <span style="color: #0000c0;">content=</span><span style="background-color: #fff0f0;">"text/html; charset=UTF-8"</span><span style="color: #007000;">/&gt;</span><br />    <span style="color: #007000;">&lt;link</span> <span style="color: #0000c0;">rel=</span><span style="background-color: #fff0f0;">"selenium.base"</span> <span style="color: #0000c0;">href=</span><span style="background-color: #fff0f0;">""</span><span style="color: #007000;">/&gt;</span><br />    <span style="color: #007000;">&lt;title&gt;</span>SomeTest1.html<span style="color: #007000;">&lt;/title&gt;</span><br /><span style="color: #007000;">&lt;/head&gt;</span><br /><span style="color: #007000;">&lt;body&gt;</span><br /><span style="color: #007000;">&lt;table</span> <span style="color: #0000c0;">cellpadding=</span><span style="background-color: #fff0f0;">"1"</span> <span style="color: #0000c0;">cellspacing=</span><span style="background-color: #fff0f0;">"1"</span> <span style="color: #0000c0;">border=</span><span style="background-color: #fff0f0;">"1"</span><span style="color: #007000;">&gt;</span><br />    <span style="color: #007000;">&lt;thead&gt;</span><br />    <span style="color: #007000;">&lt;tr&gt;</span><br />        <span style="color: #007000;">&lt;td</span> <span style="color: #0000c0;">rowspan=</span><span style="background-color: #fff0f0;">"1"</span> <span style="color: #0000c0;">colspan=</span><span style="background-color: #fff0f0;">"3"</span><span style="color: #007000;">&gt;</span>SomeTest1<span style="color: #007000;">&lt;/td&gt;</span><br />    <span style="color: #007000;">&lt;/tr&gt;</span><br />    <span style="color: #007000;">&lt;/thead&gt;</span><br />    <span style="color: #007000;">&lt;tbody&gt;</span><br />    <span style="color: #007000;">&lt;tr&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;</span>open<span style="color: #007000;">&lt;/td&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;</span>/<span style="color: #007000;">&lt;/td&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;&lt;/td&gt;</span><br />    <span style="color: #007000;">&lt;/tr&gt;</span><br />    <span style="color: #007000;">&lt;tr&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;</span>waitForElementPresent<span style="color: #007000;">&lt;/td&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;</span>//div[@id='someId']<span style="color: #007000;">&lt;/td&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;&lt;/td&gt;</span><br />    <span style="color: #007000;">&lt;/tr&gt;</span><br />    <span style="color: #007000;">&lt;tr&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;</span>click<span style="color: #007000;">&lt;/td&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;</span>css=button.create<span style="color: #007000;">&lt;/td&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;&lt;/td&gt;</span><br />    <span style="color: #007000;">&lt;/tr&gt;</span><br />    <span style="color: grey;">&lt;!-- Some Steps --&gt;</span><br />    <span style="color: #007000;">&lt;tr&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;</span>assertText<span style="color: #007000;">&lt;/td&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;</span><br />            //div[@id='someId']<br />        <span style="color: #007000;">&lt;/td&gt;</span><br />        <span style="color: #007000;">&lt;td&gt;</span>${expectedText}<span style="color: #007000;">&lt;/td&gt;</span><br />    <span style="color: #007000;">&lt;/tr&gt;</span><br />    <span style="color: #007000;">&lt;/tbody&gt;</span><br /><span style="color: #007000;">&lt;/table&gt;</span><br /><span style="color: #007000;">&lt;/body&gt;</span><br /><span style="color: #007000;">&lt;/html&gt;</span><br /></pre></td></tr></tbody></table></div><h3>&nbsp;</h3><h3>Setup WebServer</h3>So i have my TestSuite in place. But how do i run them? Most importantly, it should run within the Maven Build Process, so it will also run on Jenkins-CI or whatever. As we are testing against a real running WebApp this is an End-to-End-Test per definition. In Maven we have the opportunity to run such Tests within the <i>integration-test</i> Phase. If you want to learn more about the Maven Build Life-cycle and its phases check out <a href="http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html">this</a>. So we need some kind of WebServer to run our WebApp, otherwise the tests wont work. The WebServer should be started before the <i>integration-test</i> phase, and be stopped afterwards. We could Use <a href="http://tomcat.apache.org/maven-plugin.html">Tomcat7</a> or <a href="http://docs.codehaus.org/display/JETTY/Maven+Jetty+Plugin">Jetty</a> for example. In this example i will use the tomcat7-maven-plugin. I configure my pom.xml to start Tomcat7 <i>pre-integration-test</i>.<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #007000;">&lt;plugin&gt;</span><br />    <span style="color: #007000;">&lt;groupId&gt;</span>org.apache.tomcat.maven<span style="color: #007000;">&lt;/groupId&gt;</span><br />    <span style="color: #007000;">&lt;artifactId&gt;</span>tomcat7-maven-plugin<span style="color: #007000;">&lt;/artifactId&gt;</span><br />    <span style="color: #007000;">&lt;version&gt;</span>2.0<span style="color: #007000;">&lt;/version&gt;</span><br />    <span style="color: #007000;">&lt;executions&gt;</span><br />        <span style="color: #007000;">&lt;execution&gt;</span><br />            <span style="color: #007000;">&lt;id&gt;</span>tomcat-run<span style="color: #007000;">&lt;/id&gt;</span><br />            <span style="color: #007000;">&lt;goals&gt;</span><br />                <span style="color: #007000;">&lt;goal&gt;</span>run-war-only<span style="color: #007000;">&lt;/goal&gt;</span><br />            <span style="color: #007000;">&lt;/goals&gt;</span><br />            <span style="color: #007000;">&lt;phase&gt;</span>pre-integration-test<span style="color: #007000;">&lt;/phase&gt;</span><br />            <span style="color: #007000;">&lt;configuration&gt;</span><br />                <span style="color: #007000;">&lt;port&gt;</span>8080<span style="color: #007000;">&lt;/port&gt;</span><br />                <span style="color: #007000;">&lt;fork&gt;</span>true<span style="color: #007000;">&lt;/fork&gt;</span><br />            <span style="color: #007000;">&lt;/configuration&gt;</span><br />        <span style="color: #007000;">&lt;/execution&gt;</span><br />        <span style="color: #007000;">&lt;execution&gt;</span><br />            <span style="color: #007000;">&lt;id&gt;</span>tomcat-shutdown<span style="color: #007000;">&lt;/id&gt;</span><br />            <span style="color: #007000;">&lt;goals&gt;</span><br />                <span style="color: #007000;">&lt;goal&gt;</span>shutdown<span style="color: #007000;">&lt;/goal&gt;</span><br />            <span style="color: #007000;">&lt;/goals&gt;</span><br />            <span style="color: #007000;">&lt;phase&gt;</span>post-integration-test<span style="color: #007000;">&lt;/phase&gt;</span><br />        <span style="color: #007000;">&lt;/execution&gt;</span><br />    <span style="color: #007000;">&lt;/executions&gt;</span><br /><span style="color: #007000;">&lt;/plugin&gt;</span><br /></pre></td></tr></tbody></table></div><br />If you are running multiple Projects on a CI-Server you might consider using a different Port-Number for each Project.<br /><br /><h3>Finally: Run the Tests </h3>Last but not least we need to run the tests. Luckily there is this <a href="http://selenium-maven-plugin/">selenium-maven-plugin</a> available that does the job.<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #007000;">&lt;plugin&gt;</span><br />    <span style="color: #007000;">&lt;groupId&gt;</span>org.codehaus.mojo<span style="color: #007000;">&lt;/groupId&gt;</span><br />    <span style="color: #007000;">&lt;artifactId&gt;</span>selenium-maven-plugin<span style="color: #007000;">&lt;/artifactId&gt;</span><br />    <span style="color: #007000;">&lt;version&gt;</span>2.3<span style="color: #007000;">&lt;/version&gt;</span><br />    <span style="color: #007000;">&lt;configuration&gt;</span><br />        <span style="color: #007000;">&lt;browser&gt;</span>*firefox<span style="color: #007000;">&lt;/browser&gt;</span><br />        <span style="color: #007000;">&lt;suite&gt;</span>src/test/selenium/TestSuite.html<span style="color: #007000;">&lt;/suite&gt;</span><br />        <span style="color: #007000;">&lt;startURL&gt;</span>http://localhost:8080<span style="color: #007000;">&lt;/startURL&gt;</span><br />    <span style="color: #007000;">&lt;/configuration&gt;</span><br />    <span style="color: #007000;">&lt;executions&gt;</span><br />        <span style="color: #007000;">&lt;execution&gt;</span><br />            <span style="color: #007000;">&lt;id&gt;</span>run-selenium-tests<span style="color: #007000;">&lt;/id&gt;</span><br />            <span style="color: #007000;">&lt;phase&gt;</span>integration-test<span style="color: #007000;">&lt;/phase&gt;</span><br />            <span style="color: #007000;">&lt;goals&gt;</span><br />                <span style="color: #007000;">&lt;goal&gt;</span>selenese<span style="color: #007000;">&lt;/goal&gt;</span><br />            <span style="color: #007000;">&lt;/goals&gt;</span><br />        <span style="color: #007000;">&lt;/execution&gt;</span><br />    <span style="color: #007000;">&lt;/executions&gt;</span><br /><span style="color: #007000;">&lt;/plugin&gt;</span><br /></pre></td></tr></tbody></table></div><br />Now,&nbsp; whenever we execute <u>mvn clean verify</u> or even <u>mvn clean install</u> in console, the Tests are run and reports are stored within the target directory. This will also be done by your CI-Tool.<br /><br /><h3>Conclusion</h3>We do have a complete and clean Setup.<br /><ul><li>We have a place to store our Tests,&nbsp;&nbsp; </li><li>They are within the Sourcecode and Version control</li><li>They can be run automatically by CI-Tools</li><li>Even Non-developers can add new TestCases</li></ul>Btw: Dont give up if something is not working as intended. Selenium seems a little buggy, and some times you have to dig a little to solve problems. But it really works, i figured it out.<br />I hope you enjoyed this Guide. Greetings.<br /><br />