<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="https://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
      Gregor Riegler &middot; Getting better at CI
    
  </title>

  


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.ico" />

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <!-- Additional head bits without overriding original head -->
<meta name="description" content="Gregor Riegler, Software Development Coach."/>
</head>


  <body class="post">

    <div id="sidebar">
  <header>
    <div class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        Gregor Riegler
      </a>
    </div>
    <p class="lead">Merciless Refactorer</p>
  </header>
  <nav id="sidebar-nav-links">
  

  


  

  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
      <a class="page-link "
          href="/about">About</a>
    
  

  
    
      <a class="page-link "
          href="/blog">Blog</a>
    
  

  
    
      <a class="page-link "
          href="/speaking">Public Speaking</a>
    
  

  
    
      <a class="page-link "
          href="/refactoring-java/">Refactoring Java Series</a>
    
  



  

  

  


  

  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>


  

  <nav id="sidebar-icon-links">

  <a id="bluesky-link"
     class="icon" title="Bluesky" aria-label="Bluesky"
     href="https://bsky.app/profile/gregorriegler.com">
    <?xml version="1.0" encoding="UTF-8"?>
<svg width="24" height="21" viewBox="0 0 600 530" version="1.1" xmlns="http://www.w3.org/2000/svg">
 <path d="m135.72 44.03c66.496 49.921 138.02 151.14 164.28 205.46 26.262-54.316 97.782-155.54 164.28-205.46 47.98-36.021 125.72-63.892 125.72 24.795 0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-0.0174-2.9357-1.1937 0.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07 0-88.687 77.742-60.816 125.72-24.795z"/>
</svg>

  </a>

  <a id="mastodon-link"
     class="icon" title="Mastodon" aria-label="Mastodon"
     href="https://fosstodon.org/@gregorriegler">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="26" viewBox="0 0 216.4144 232.00976">
  <defs>
    <mask id="mastodon-mask">
      <rect width="100%" height="100%" fill="white"/>
      <path d="M177.50984 80.077v60.94125h-24.14375v-59.15c0-12.46875-5.24625-18.7975-15.74-18.7975-11.6025 0-17.4175 7.5075-17.4175 22.3525v32.37625H96.20734V85.42325c0-14.845-5.81625-22.3525-17.41875-22.3525-10.49375 0-15.74 6.32875-15.74 18.7975v59.15H38.90484V80.077c0-12.455 3.17125-22.3525 9.54125-29.675 6.56875-7.3225 15.17125-11.07625 25.85-11.07625 12.355 0 21.71125 4.74875 27.8975 14.2475l6.01375 10.08125 6.015-10.08125c6.185-9.49875 15.54125-14.2475 27.8975-14.2475 10.6775 0 19.28 3.75375 25.85 11.07625 6.36875 7.3225 9.54 17.22 9.54 29.675" fill="black"/>
    </mask>
  </defs>
  <path d="M211.80734 139.0875c-3.18125 16.36625-28.4925 34.2775-57.5625 37.74875-15.15875 1.80875-30.08375 3.47125-45.99875 2.74125-26.0275-1.1925-46.565-6.2125-46.565-6.2125 0 2.53375.15625 4.94625.46875 7.2025 3.38375 25.68625 25.47 27.225 46.39125 27.9425 21.11625.7225 39.91875-5.20625 39.91875-5.20625l.8675 19.09s-14.77 7.93125-41.08125 9.39c-14.50875.7975-32.52375-.365-53.50625-5.91875C9.23234 213.82 1.40609 165.31125.20859 116.09125c-.365-14.61375-.14-28.39375-.14-39.91875 0-50.33 32.97625-65.0825 32.97625-65.0825C49.67234 3.45375 78.20359.2425 107.86484 0h.72875c29.66125.2425 58.21125 3.45375 74.8375 11.09 0 0 32.975 14.7525 32.975 65.0825 0 0 .41375 37.13375-4.59875 62.915" mask="url(#mastodon-mask)"/>
</svg>

  </a>

  <a id="linkedin-link"
     class="icon" title="LinkedIn" aria-label="LinkedIn"
     href="https://www.linkedin.com/in/gregorriegler/">
    <?xml version="1.0" ?>
<svg height="24" viewBox="0 0 72 72" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M62,62 L51.315625,62 L51.315625,43.8021149 C51.315625,38.8127542 49.4197917,36.0245323 45.4707031,36.0245323 C41.1746094,36.0245323 38.9300781,38.9261103 38.9300781,43.8021149 L38.9300781,62 L28.6333333,62 L28.6333333,27.3333333 L38.9300781,27.3333333 L38.9300781,32.0029283 C38.9300781,32.0029283 42.0260417,26.2742151 49.3825521,26.2742151 C56.7356771,26.2742151 62,30.7644705 62,40.051212 L62,62 Z M16.349349,22.7940133 C12.8420573,22.7940133 10,19.9296567 10,16.3970067 C10,12.8643566 12.8420573,10 16.349349,10 C19.8566406,10 22.6970052,12.8643566 22.6970052,16.3970067 C22.6970052,19.9296567 19.8566406,22.7940133 16.349349,22.7940133 Z M11.0325521,62 L21.769401,62 L21.769401,27.3333333 L11.0325521,27.3333333 L11.0325521,62 Z"/>
</svg>
  </a>
  
  <a id="github-link"
     class="icon" title="Github" aria-label="Github"
     href="https://github.com/gregorriegler">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 28" height="24" width="28"><path d="M12 2c6.625 0 12 5.375 12 12 0 5.297-3.437 9.797-8.203 11.391-0.609 0.109-0.828-0.266-0.828-0.578 0-0.391 0.016-1.687 0.016-3.297 0-1.125-0.375-1.844-0.812-2.219 2.672-0.297 5.484-1.313 5.484-5.922 0-1.313-0.469-2.375-1.234-3.219 0.125-0.313 0.531-1.531-0.125-3.187-1-0.313-3.297 1.234-3.297 1.234-0.953-0.266-1.984-0.406-3-0.406s-2.047 0.141-3 0.406c0 0-2.297-1.547-3.297-1.234-0.656 1.656-0.25 2.875-0.125 3.187-0.766 0.844-1.234 1.906-1.234 3.219 0 4.594 2.797 5.625 5.469 5.922-0.344 0.313-0.656 0.844-0.766 1.609-0.688 0.313-2.438 0.844-3.484-1-0.656-1.141-1.844-1.234-1.844-1.234-1.172-0.016-0.078 0.734-0.078 0.734 0.781 0.359 1.328 1.75 1.328 1.75 0.703 2.141 4.047 1.422 4.047 1.422 0 1 0.016 1.937 0.016 2.234 0 0.313-0.219 0.688-0.828 0.578-4.766-1.594-8.203-6.094-8.203-11.391 0-6.625 5.375-12 12-12zM4.547 19.234c0.031-0.063-0.016-0.141-0.109-0.187-0.094-0.031-0.172-0.016-0.203 0.031-0.031 0.063 0.016 0.141 0.109 0.187 0.078 0.047 0.172 0.031 0.203-0.031zM5.031 19.766c0.063-0.047 0.047-0.156-0.031-0.25-0.078-0.078-0.187-0.109-0.25-0.047-0.063 0.047-0.047 0.156 0.031 0.25 0.078 0.078 0.187 0.109 0.25 0.047zM5.5 20.469c0.078-0.063 0.078-0.187 0-0.297-0.063-0.109-0.187-0.156-0.266-0.094-0.078 0.047-0.078 0.172 0 0.281s0.203 0.156 0.266 0.109zM6.156 21.125c0.063-0.063 0.031-0.203-0.063-0.297-0.109-0.109-0.25-0.125-0.313-0.047-0.078 0.063-0.047 0.203 0.063 0.297 0.109 0.109 0.25 0.125 0.313 0.047zM7.047 21.516c0.031-0.094-0.063-0.203-0.203-0.25-0.125-0.031-0.266 0.016-0.297 0.109s0.063 0.203 0.203 0.234c0.125 0.047 0.266 0 0.297-0.094zM8.031 21.594c0-0.109-0.125-0.187-0.266-0.172-0.141 0-0.25 0.078-0.25 0.172 0 0.109 0.109 0.187 0.266 0.172 0.141 0 0.25-0.078 0.25-0.172zM8.937 21.438c-0.016-0.094-0.141-0.156-0.281-0.141-0.141 0.031-0.234 0.125-0.219 0.234 0.016 0.094 0.141 0.156 0.281 0.125s0.234-0.125 0.219-0.219z"></path>
</svg>

  </a>

  <a id="youtube-link"
     class="icon" title="Youtube" aria-label="Youtube"
     href="https://www.youtube.com/channel/UCsWg_i6X4KMhjD2CRqCJLdg">
    <?xml version="1.0" encoding="iso-8859-1"?>
<!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="96.875px" height="96.875px" viewBox="0 0 96.875 96.875" style="enable-background:new 0 0 96.875 96.875;"
	 xml:space="preserve">
<g>
	<path d="M95.201,25.538c-1.186-5.152-5.4-8.953-10.473-9.52c-12.013-1.341-24.172-1.348-36.275-1.341
		c-12.105-0.007-24.266,0-36.279,1.341c-5.07,0.567-9.281,4.368-10.467,9.52C0.019,32.875,0,40.884,0,48.438
		C0,55.992,0,64,1.688,71.336c1.184,5.151,5.396,8.952,10.469,9.52c12.012,1.342,24.172,1.349,36.277,1.342
		c12.107,0.007,24.264,0,36.275-1.342c5.07-0.567,9.285-4.368,10.471-9.52c1.689-7.337,1.695-15.345,1.695-22.898
		C96.875,40.884,96.889,32.875,95.201,25.538z M35.936,63.474c0-10.716,0-21.32,0-32.037c10.267,5.357,20.466,10.678,30.798,16.068
		C56.434,52.847,46.23,58.136,35.936,63.474z"/>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
</svg>

  </a>

  <a id="goodreads-link"
     class="icon" title="goodreads" aria-label="goodreads"
     href="https://www.goodreads.com/user/show/22567057-gregor-riegler">
    <?xml version="1.0" ?><svg style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><style type="text/css">
	.st0{}
	.st1{fill:#202020;}
</style><g id="Edges"/><g id="Background_1_"><path class="st0" d="M492,268.3c-6.3,122.8-109.9,224.4-236.5,224.5c-126.7,0.1-230.7-101.6-237-224.5   C11.7,136.2,119.6,19.2,255.2,19.2C390.9,19.2,498.7,136.3,492,268.3z"/></g><g id="Symbol"><path class="st1" d="M346.6,137.5c0-4.3-0.4-8.6-0.6-12.8c-9.2,0-16.9,0-25.6,0c0,9.8,0,18.9,0,28.1   c-41.1-57.3-125.6-39.2-149.4,17.9c-15.2,36.6-14.4,73.4,1.5,109.4c16.8,38,65,54.1,102.8,43.4c2-0.3,4.3-0.9,6.8-1.7   c3.6-1.1,6.7-2.5,8.7-3.6c5.2-2.1,11.4-5.6,17.5-10.3c4.9-3.8,9.1-7.8,12.4-11.5c-0.9,14.3-1.3,28.7-3.6,42.8   c-2.8,17.4-10.8,32.4-27.4,41.2c-36.2,19.2-79.6,4.6-96-32.4c-8.2,0-16.6,0-25.4,0c1.8,24.4,14.7,40.3,34.7,50.6   c24.1,12.4,49.9,13.7,76.2,9.4c33.5-5.5,55.3-24.4,63-57.8c2.7-11.9,4.2-24.2,4.3-36.4C346.8,255,346.6,196.2,346.6,137.5z    M316.5,260.3c-4.8,13.8-12.8,24.7-23.3,32.2c-2.6,1.9-15.4,10.8-34.1,11.7c-1.1,0.1-4.2,0.2-8,0c-0.1,0.1-0.3,0.1-0.4,0.1   c-27.3-1.7-48.2-17.6-57.4-43.9c-7.7-22.1-7.9-44.6-2.3-67.1c8.1-32.5,31.6-52.4,61.6-53.2c0.7-0.1,1.1-0.1,1.1-0.1   c15.6-1.4,27.8,5.1,31.6,7.2c16.1,8.6,28.2,24.6,33.5,46C324.4,215.7,324.2,238.2,316.5,260.3z"/></g></svg>
  </a>

  <a id="email-link"
     class="icon" title="e-mail" aria-label="e-mail"
     href="mailto:rieglerg85@gmail.com">
    <?xml version="1.0" encoding="iso-8859-1"?>
<!-- Generator: Adobe Illustrator 18.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 493.332 493.332" style="enable-background:new 0 0 493.332 493.332;" xml:space="preserve">
<g id="XMLID_78_">
	<g id="XMLID_79_">
		<g id="XMLID_80_">
			<path id="XMLID_81_" d="M352.731,450.956c3.037,9.789-2.044,20.213-11.616,23.878c-35.811,13.709-69.294,18.498-112.873,18.498
				c-117.663,0-221.147-84.347-221.147-223.275C7.095,125.46,112.003,0,272.2,0c124.735,0,214.036,85.764,214.036,204.845
				c0,103.483-58.12,168.693-134.66,168.693c-33.327,0-57.419-17.007-60.955-54.582h-1.424c-21.963,36.15-53.86,54.582-91.43,54.582
				c-46.082,0-79.376-34.022-79.376-92.142c0-86.475,63.769-165.147,165.841-165.147c18.691,0,38.9,2.795,55.909,7.172
				c16.425,4.227,26.861,20.236,24.147,36.978l-16.972,104.695c-7.072,41.818-2.112,60.953,17.721,61.666
				c30.475,0.711,68.762-38.272,68.762-119.786c0-92.15-59.543-163.732-169.41-163.732c-108.444,0-203.428,85.051-203.428,220.436
				c0,118.369,75.834,185.708,181.448,185.708c27.489,0,56.203-4.51,80.853-13.214c5.863-2.07,12.315-1.662,17.872,1.126
				c5.558,2.788,9.753,7.716,11.595,13.655L352.731,450.956z M293.954,181.362c0.534-3.626-1.892-7.027-5.496-7.696
				c-4.413-0.819-9.536-1.426-15.573-1.426c-46.771,0-83.617,46.076-83.617,100.653c0,26.94,12.037,43.946,35.423,43.946
				c26.231,0,53.876-33.31,60.265-74.425L293.954,181.362z"/>
		</g>
	</g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
<g>
</g>
</svg>

  </a>

  <a id="subscribe-link"
     class="icon" title="Subscribe" aria-label="Subscribe"
     href="/feed.xml">
    <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>
  </a>

  
  
  
  

  

  

  <!-- Optional additional links to insert for icons links -->
</nav>

  <p class="license">
  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0; margin: 0 0 .5rem" width="20" src="/assets/img/cc_icon_white_x2.png" /></a>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a> by <a href="http://gregorriegler.com">Gregor Riegler</a>.
  Layout: &copy; 2025.  <a href="/THEME_LICENSE.md">MIT License.</a>
</p>

</div>

    <main class="container">
      <header>
  <h1 class="post-title">Getting better at CI</h1>
</header>
<div class="content">
  <div class="post-meta">
  <span class="post-date">21 Jul 2022</span>
  <span class="post-categories">
    
  </span>
</div>


  <div class="post-body">
    <p>I recently felt the urge to experiment with my TDD workflow and improve it.
It had too many manual steps, like running the tests, starting a commit, writing a commit message, pulling changes, and pushing it. 
It felt boring and wasteful.
I want to automate this stuff and eliminate all the waste.</p>

<p>We’re not aiming high enough with the continuous part in CI/CD.<br />
<em>“Integrate at least daily”</em> … Come on!<br />
<em>“Hourly”</em> … We can do better than this.<br />
<em>“Short-lived Feature Branches”</em> … You got to be kidding. It’s rather <em>“short-lived lies”</em>.<br />
None of this is continuous.
We need to get better and decrease the risk even further.
I want to integrate <em>actually continuously</em>.</p>

<p>My inspiration comes mainly from the ideas of <a href="https://martinfowler.com/articles/continuousIntegration.html">continuous integration</a>, continuous testing, <a href="https://medium.com/@kentbeck_7670/test-commit-revert-870bbd756864">TCR</a>, and <a href="https://medium.com/@kentbeck_7670/limbo-on-the-cheap-e4cfae840330">limbo on the cheap</a>.</p>

<h2 id="actually-continuously">Actually continuously</h2>

<p>I came up with a way that drastically increased my commit frequency.
I managed to create <strong>63 commits</strong> in just <strong>25 minutes</strong> practicing this way, where I peaked at <strong>6 commits per minute</strong>. 
Yes, it was just a kata, but that’s not the important part.
On many occasions literally every keystroke went live, and it was all working - covered by tests.</p>

<p>What I did is based on the following requirements:</p>

<ul>
  <li><strong>No manual saving</strong>. The code saves itself automatically.</li>
  <li><strong>No manual test running</strong>. The tests run continuously. They restart automatically as soon as the code changes. And they are <em>fast</em>.</li>
  <li><strong>No manual commits</strong>. The code is committed automatically whenever the tests pass.</li>
  <li><strong>No manual pulling</strong>. Changes are pulled automatically before the tests run.</li>
  <li><strong>No manual pushing</strong>. Every commit is automatically pushed right away.</li>
</ul>

<p>Not that hard to achieve actually.
Just need proper tooling and a little bit of scripting.
The language I’m trying this with is Java.</p>

<h2 id="the-right-tools-for-the-job">The right tools for the job</h2>

<p>Since I use IntelliJ, which is a great, maybe the best IDE (*<em>cough</em>* it became a little buggy as of recent *<em>cough</em>*), it saves my code automatically. 
So that problem is already solved.
For the continuous running of the tests, I know a few options.<br />
IntelliJ offers a way to trigger the tests automatically, but it’s rather slow.
Then there is this old-school plugin <a href="https://infinitest.github.io/">infinitest</a>, but I need something for the CLI so I am able to script it. 
And it should be really fast. <a href="https://en.wikipedia.org/wiki/Incremental_compiler">Incremental compilation</a> would be key.<br />
<a href="https://blog.gradle.org/introducing-continuous-build">Gradle</a> has it, and it is quite fast.
With Gradle, I could also make the test report pretty using this <a href="https://github.com/radarsh/gradle-test-logger-plugin">test-logger plugin</a>.</p>

<p><img src="/assets/not-continuous-enough/nice-test-report.png" alt="Nice test report with the gradle test logger" /></p>

<p>I like that!</p>

<p>Another option would be the <a href="https://quarkus.io/guides/continuous-testing">quarkus continuous test runner</a>, which is fairly new, and its test report is so ugly.
Also, I have no idea how to customize, or script it.
So I am going with Gradle for now.</p>

<p>On top of the incremental compilation, Gradle ships with a continuous test runner in:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> gradle <span class="nt">-t</span> <span class="nb">test</span>
</code></pre></div></div>
<p>But since I need more control I chose to use a little helper tool called <a href="https://github.com/watchexec/watchexec">watchexec</a> instead.
It watches for file changes and then executes a command.
Like this:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> watchexec <span class="nt">-e</span> java ./gradlew <span class="nb">test</span>
</code></pre></div></div>
<p>I made some tests and it is just as fast as the Gradle continuous test runner.
If you’d like even more control and a more complicated script, you could also use <a href="https://linux.die.net/man/1/inotifywait">inotifywait</a>.
However, I like to keep it as simple as possible.</p>

<p>Next, I needed to commit as soon as the tests pass. 
A simple bash script would do, but I like to use a modern task runner for the job.
I settled with <a href="https://github.com/casey/just">just</a>. 
In case you did not know, it is a modern version of <a href="https://savannah.gnu.org/projects/make">Make</a>.
And it is written in rust for whoever that may concern.
The way this works is you <em>just</em> create a <code class="language-plaintext highlighter-rouge">justfile</code> and specify your tasks in it.
The commit command looks like this.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>commit:
    @git add <span class="nb">.</span> 
    -@git commit <span class="nt">-am</span> <span class="s2">"wip"</span>
</code></pre></div></div>

<p>Simple and concise. 
To execute it you run:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> just commit
</code></pre></div></div>
<p>And I do not even have to remember.
My shell courteously suggests to me the available commands.<br />
The <code class="language-plaintext highlighter-rouge">@</code> means that the command is not printed.<br />
By default <code class="language-plaintext highlighter-rouge">just</code> would abort on an error exit code, whereas the <code class="language-plaintext highlighter-rouge">-</code> tells it to ignore that and continue.
I need this for the case where the tests pass, but I have not changed anything.
For example when I add something and delete it right away.
Then there would be nothing to commit, and <code class="language-plaintext highlighter-rouge">git</code> would throw the error, having <code class="language-plaintext highlighter-rouge">just</code> abort the task.
I could also allow the empty commit using the <a href="https://git-scm.com/docs/git-commit#Documentation/git-commit.txt---allow-empty">allow-empty</a> flag.
But why allow an empty commit for no reason!?
That would be inventory, wasteful.</p>

<p>So here are the first commands in a <code class="language-plaintext highlighter-rouge">justfile</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>commit:
    @git add <span class="nb">.</span> 
    -@git commit <span class="nt">-am</span> <span class="s2">"wip"</span>
    
<span class="nb">test</span>:
    clear
    @./gradlew <span class="nb">test

</span>test-commit:
    just <span class="nb">test 
    </span>just commit

tdd-commit:
    watchexec <span class="nt">-e</span> java just test-commit
</code></pre></div></div>

<p>Nice! I like it.</p>

<h2 id="first-try">First Try</h2>
<p>Now we are able to give it a try.
Small steps.</p>

<ul>
  <li>Run <code class="language-plaintext highlighter-rouge">&gt; just tdd-commit</code> in a terminal that stays visible next to the IDE.</li>
  <li>Write a very simple failing test; <strong>Tests fail</strong>. -&gt; The test failure is shown in the terminal immediately.</li>
  <li>Make the <strong>test pass</strong>. -&gt; Nicely formatted test report is shown immediately. Changes commit automatically.</li>
  <li>Rename the test method; <strong>Tests pass</strong>. -&gt; Changes commit automatically.</li>
  <li>Add another test; <strong>Tests fail</strong>. -&gt; I am shown the failure report.</li>
  <li>In a first attempt to make it pass I notice I cannot make it as easily. I need a preparatory refactoring first.</li>
  <li>So I disable the failing test; <strong>Tests pass again</strong>. -&gt; Changes commit automatically.</li>
  <li>I do the preparatory refactoring; <strong>Tests pass</strong>. -&gt; Changes commit automatically.</li>
  <li>I enable the failing test again; <strong>Tests fail</strong>. -&gt; I am shown the failure report.</li>
  <li>Make it pass this time; <strong>Tests pass</strong>. -&gt; Changes commit automatically.</li>
</ul>

<p>Wow, this felt smooth.
During all of this, I had not manually done a single save, test run, or commit.
The terminal was open on the right-hand side of my screen, and I got that feedback immediately, continuously.</p>

<h2 id="a-meaningless-commit-history">A meaningless commit history</h2>
<p>Let’s take a look at the resulting git history.</p>

<ul>
  <li>wip</li>
  <li>wip</li>
  <li>wip</li>
  <li>wip</li>
  <li>wip</li>
</ul>

<p>Whoops, that’s not very expressive.
But the commits are so small and pleasant to review.
It’s like a playback of every little step that was taken.
It is the actual history.
Honestly, I think the flow might have more value than the documentation.
Still, I would like to improve on that by sneaking in descriptive empty commits every once in a while.</p>

<p>We are used to writing git messages that describe what we did after we did it.
But for this, I would like to propose a different way.
I want to use a commit message to describe what is next. In other words: What my current goal is.
So let’s add a command to create such descriptive empty commits.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>goal +MESSAGE:
    git commit <span class="nt">--allow-empty</span> <span class="nt">-m</span> <span class="s2">"Goal: {{MESSAGE}}"</span>
</code></pre></div></div>

<p>Every time I start working on a new goal, I want to write it to my git history first.
Something like <code class="language-plaintext highlighter-rouge">&gt; just goal make rover turn left</code>.
The other commit messages would stay ‘wip’ commits and that’s fine.
One idea would be to use further tooling to decode some of the refactoring commits.
For example: The <a href="https://plugins.jetbrains.com/plugin/14704-refactorinsight">refactoringinsight</a> plugin.</p>

<p>My commit history would then look something like this:</p>

<ul>
  <li>wip</li>
  <li>wip</li>
  <li>wip</li>
  <li>Goal: make rover turn left</li>
  <li>wip</li>
  <li>wip</li>
  <li>wip</li>
  <li>wip</li>
  <li>Goal: make rover turn right</li>
</ul>

<h2 id="but-what-about-integration">But what about Integration?</h2>
<p>Lots of small commits on my computer are nice.
But if I work in a team I need to integrate my changes to the mainline, too.
So I want to pull before I run my tests, and I want to push after each commit.
It’s called Continuous Integration for a reason, right?</p>

<p>Let’s add that to the justfile.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>integrate:     
    git pull <span class="nt">--rebase</span>
    just <span class="nb">test    
    </span>just commit  
    git push
</code></pre></div></div>
<p>And I think we’re done.</p>

<p>This is the complete <a href="https://gist.github.com/gregorriegler/eafaa74250ff166925296dd58d4e62be">file</a>. 
It also contains a TCR task.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>goal +MESSAGE:
    git pull <span class="nt">--rebase</span>
    git commit <span class="nt">--allow-empty</span> <span class="nt">-m</span> <span class="s2">"Goal: {{MESSAGE}}"</span>
    git push

commit:
    @git add <span class="nb">.</span> 
    -@git commit <span class="nt">-am</span> <span class="s2">"wip"</span>

<span class="nb">test</span>:
    clear
    @./gradlew <span class="nb">test
    
</span>integrate:
    git pull <span class="nt">--rebase</span>
    just <span class="nb">test 
    </span>just commit
    git push
    
tdd:
    watchexec <span class="nt">-e</span> java just <span class="nb">test

</span>ci:
    watchexec <span class="nt">-e</span> java just integrate

revert:
    @git reset <span class="nt">--hard</span> &amp;&gt; /dev/null
    @git clean <span class="nt">-df</span> &amp;&gt; /dev/null
    @echo <span class="nt">-e</span> <span class="s2">"</span><span class="se">\0</span><span class="s2">33[0;31m=== REVERTED ==="</span>
    
tcr:
    @just <span class="nb">test</span> <span class="o">&amp;&amp;</span> just commit <span class="o">||</span> just revert
</code></pre></div></div>

<h2 id="conclusion">Conclusion</h2>
<p>Notice how I renamed the <code class="language-plaintext highlighter-rouge">tdd-commit</code> task to <code class="language-plaintext highlighter-rouge">ci</code>.
Continuous Integration is not only about what the build server is doing, it is primarily about what we do.</p>

<p>Coding with this script feels super smooth. 
It is actually continuous.</p>

<p>Also, it was not that complicated to set up.
You can probably do even better.</p>

<p>Imagine remote pair- or mob programming with this.
Hand-overs could not be easier. 
You just exchange the screen-sharing while the tests pass.
And that’s it.</p>

<p>Probably some people are already working this way? Let me know!</p>


    



<div class="post-tags clear">
  
    <span>
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">TDD</span>
    </span>
  
    <span>
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Continuous Integration</span>
    </span>
  
</div>
  </div>

  <section class="related">
  <h2>Related Posts</h2>
  <ul class="posts-list">
    
      <li>
        <h3>
          <a href="/2025/07/12/augmented-coding-pattern-language.html">
            Augmented Coding - A Pattern Language
            <small>12 Jul 2025</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2023/10/21/geecon-prague-summary.html">
            Takeaways from GeeCon Prague 2023
            <small>21 Oct 2023</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2023/01/30/solo-programming-considered-bad.html">
            Solo Programming Considered Harmful
            <small>30 Jan 2023</small>
          </a>
        </h3>
      </li>
    
  </ul>
</section>

</div>

    </main>

    <!-- Optional footer content -->

  </body>
</html>
